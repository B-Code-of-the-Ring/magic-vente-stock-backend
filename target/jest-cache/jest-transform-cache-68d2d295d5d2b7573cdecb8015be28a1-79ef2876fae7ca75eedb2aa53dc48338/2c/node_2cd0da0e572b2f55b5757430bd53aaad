7cb376b69259e768839f4364fcfd69e1
'use strict';

let {
  isClean,
  my
} = require('./symbols');
let CssSyntaxError = require('./css-syntax-error');
let Stringifier = require('./stringifier');
let stringify = require('./stringify');
function cloneNode(obj, parent) {
  let cloned = new obj.constructor();
  for (let i in obj) {
    if (!Object.prototype.hasOwnProperty.call(obj, i)) {
      /* c8 ignore next 2 */
      continue;
    }
    if (i === 'proxyCache') continue;
    let value = obj[i];
    let type = typeof value;
    if (i === 'parent' && type === 'object') {
      if (parent) cloned[i] = parent;
    } else if (i === 'source') {
      cloned[i] = value;
    } else if (Array.isArray(value)) {
      cloned[i] = value.map(j => cloneNode(j, cloned));
    } else {
      if (type === 'object' && value !== null) value = cloneNode(value);
      cloned[i] = value;
    }
  }
  return cloned;
}
class Node {
  constructor(defaults = {}) {
    this.raws = {};
    this[isClean] = false;
    this[my] = true;
    for (let name in defaults) {
      if (name === 'nodes') {
        this.nodes = [];
        for (let node of defaults[name]) {
          if (typeof node.clone === 'function') {
            this.append(node.clone());
          } else {
            this.append(node);
          }
        }
      } else {
        this[name] = defaults[name];
      }
    }
  }
  addToError(error) {
    error.postcssNode = this;
    if (error.stack && this.source && /\n\s{4}at /.test(error.stack)) {
      let s = this.source;
      error.stack = error.stack.replace(/\n\s{4}at /, `$&${s.input.from}:${s.start.line}:${s.start.column}$&`);
    }
    return error;
  }
  after(add) {
    this.parent.insertAfter(this, add);
    return this;
  }
  assign(overrides = {}) {
    for (let name in overrides) {
      this[name] = overrides[name];
    }
    return this;
  }
  before(add) {
    this.parent.insertBefore(this, add);
    return this;
  }
  cleanRaws(keepBetween) {
    delete this.raws.before;
    delete this.raws.after;
    if (!keepBetween) delete this.raws.between;
  }
  clone(overrides = {}) {
    let cloned = cloneNode(this);
    for (let name in overrides) {
      cloned[name] = overrides[name];
    }
    return cloned;
  }
  cloneAfter(overrides = {}) {
    let cloned = this.clone(overrides);
    this.parent.insertAfter(this, cloned);
    return cloned;
  }
  cloneBefore(overrides = {}) {
    let cloned = this.clone(overrides);
    this.parent.insertBefore(this, cloned);
    return cloned;
  }
  error(message, opts = {}) {
    if (this.source) {
      let {
        end,
        start
      } = this.rangeBy(opts);
      return this.source.input.error(message, {
        column: start.column,
        line: start.line
      }, {
        column: end.column,
        line: end.line
      }, opts);
    }
    return new CssSyntaxError(message);
  }
  getProxyProcessor() {
    return {
      get(node, prop) {
        if (prop === 'proxyOf') {
          return node;
        } else if (prop === 'root') {
          return () => node.root().toProxy();
        } else {
          return node[prop];
        }
      },
      set(node, prop, value) {
        if (node[prop] === value) return true;
        node[prop] = value;
        if (prop === 'prop' || prop === 'value' || prop === 'name' || prop === 'params' || prop === 'important' || /* c8 ignore next */
        prop === 'text') {
          node.markDirty();
        }
        return true;
      }
    };
  }
  markDirty() {
    if (this[isClean]) {
      this[isClean] = false;
      let next = this;
      while (next = next.parent) {
        next[isClean] = false;
      }
    }
  }
  next() {
    if (!this.parent) return undefined;
    let index = this.parent.index(this);
    return this.parent.nodes[index + 1];
  }
  positionBy(opts, stringRepresentation) {
    let pos = this.source.start;
    if (opts.index) {
      pos = this.positionInside(opts.index, stringRepresentation);
    } else if (opts.word) {
      stringRepresentation = this.toString();
      let index = stringRepresentation.indexOf(opts.word);
      if (index !== -1) pos = this.positionInside(index, stringRepresentation);
    }
    return pos;
  }
  positionInside(index, stringRepresentation) {
    let string = stringRepresentation || this.toString();
    let column = this.source.start.column;
    let line = this.source.start.line;
    for (let i = 0; i < index; i++) {
      if (string[i] === '\n') {
        column = 1;
        line += 1;
      } else {
        column += 1;
      }
    }
    return {
      column,
      line
    };
  }
  prev() {
    if (!this.parent) return undefined;
    let index = this.parent.index(this);
    return this.parent.nodes[index - 1];
  }
  rangeBy(opts) {
    let start = {
      column: this.source.start.column,
      line: this.source.start.line
    };
    let end = this.source.end ? {
      column: this.source.end.column + 1,
      line: this.source.end.line
    } : {
      column: start.column + 1,
      line: start.line
    };
    if (opts.word) {
      let stringRepresentation = this.toString();
      let index = stringRepresentation.indexOf(opts.word);
      if (index !== -1) {
        start = this.positionInside(index, stringRepresentation);
        end = this.positionInside(index + opts.word.length, stringRepresentation);
      }
    } else {
      if (opts.start) {
        start = {
          column: opts.start.column,
          line: opts.start.line
        };
      } else if (opts.index) {
        start = this.positionInside(opts.index);
      }
      if (opts.end) {
        end = {
          column: opts.end.column,
          line: opts.end.line
        };
      } else if (typeof opts.endIndex === 'number') {
        end = this.positionInside(opts.endIndex);
      } else if (opts.index) {
        end = this.positionInside(opts.index + 1);
      }
    }
    if (end.line < start.line || end.line === start.line && end.column <= start.column) {
      end = {
        column: start.column + 1,
        line: start.line
      };
    }
    return {
      end,
      start
    };
  }
  raw(prop, defaultType) {
    let str = new Stringifier();
    return str.raw(this, prop, defaultType);
  }
  remove() {
    if (this.parent) {
      this.parent.removeChild(this);
    }
    this.parent = undefined;
    return this;
  }
  replaceWith(...nodes) {
    if (this.parent) {
      let bookmark = this;
      let foundSelf = false;
      for (let node of nodes) {
        if (node === this) {
          foundSelf = true;
        } else if (foundSelf) {
          this.parent.insertAfter(bookmark, node);
          bookmark = node;
        } else {
          this.parent.insertBefore(bookmark, node);
        }
      }
      if (!foundSelf) {
        this.remove();
      }
    }
    return this;
  }
  root() {
    let result = this;
    while (result.parent && result.parent.type !== 'document') {
      result = result.parent;
    }
    return result;
  }
  toJSON(_, inputs) {
    let fixed = {};
    let emitInputs = inputs == null;
    inputs = inputs || new Map();
    let inputsNextIndex = 0;
    for (let name in this) {
      if (!Object.prototype.hasOwnProperty.call(this, name)) {
        /* c8 ignore next 2 */
        continue;
      }
      if (name === 'parent' || name === 'proxyCache') continue;
      let value = this[name];
      if (Array.isArray(value)) {
        fixed[name] = value.map(i => {
          if (typeof i === 'object' && i.toJSON) {
            return i.toJSON(null, inputs);
          } else {
            return i;
          }
        });
      } else if (typeof value === 'object' && value.toJSON) {
        fixed[name] = value.toJSON(null, inputs);
      } else if (name === 'source') {
        let inputId = inputs.get(value.input);
        if (inputId == null) {
          inputId = inputsNextIndex;
          inputs.set(value.input, inputsNextIndex);
          inputsNextIndex++;
        }
        fixed[name] = {
          end: value.end,
          inputId,
          start: value.start
        };
      } else {
        fixed[name] = value;
      }
    }
    if (emitInputs) {
      fixed.inputs = [...inputs.keys()].map(input => input.toJSON());
    }
    return fixed;
  }
  toProxy() {
    if (!this.proxyCache) {
      this.proxyCache = new Proxy(this, this.getProxyProcessor());
    }
    return this.proxyCache;
  }
  toString(stringifier = stringify) {
    if (stringifier.stringify) stringifier = stringifier.stringify;
    let result = '';
    stringifier(this, i => {
      result += i;
    });
    return result;
  }
  warn(result, text, opts) {
    let data = {
      node: this
    };
    for (let i in opts) data[i] = opts[i];
    return result.warn(text, data);
  }
  get proxyOf() {
    return this;
  }
}
module.exports = Node;
Node.default = Node;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJpc0NsZWFuIiwibXkiLCJyZXF1aXJlIiwiQ3NzU3ludGF4RXJyb3IiLCJTdHJpbmdpZmllciIsInN0cmluZ2lmeSIsImNsb25lTm9kZSIsIm9iaiIsInBhcmVudCIsImNsb25lZCIsImNvbnN0cnVjdG9yIiwiaSIsIk9iamVjdCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsInZhbHVlIiwidHlwZSIsIkFycmF5IiwiaXNBcnJheSIsIm1hcCIsImoiLCJOb2RlIiwiZGVmYXVsdHMiLCJyYXdzIiwibmFtZSIsIm5vZGVzIiwibm9kZSIsImNsb25lIiwiYXBwZW5kIiwiYWRkVG9FcnJvciIsImVycm9yIiwicG9zdGNzc05vZGUiLCJzdGFjayIsInNvdXJjZSIsInRlc3QiLCJzIiwicmVwbGFjZSIsImlucHV0IiwiZnJvbSIsInN0YXJ0IiwibGluZSIsImNvbHVtbiIsImFmdGVyIiwiYWRkIiwiaW5zZXJ0QWZ0ZXIiLCJhc3NpZ24iLCJvdmVycmlkZXMiLCJiZWZvcmUiLCJpbnNlcnRCZWZvcmUiLCJjbGVhblJhd3MiLCJrZWVwQmV0d2VlbiIsImJldHdlZW4iLCJjbG9uZUFmdGVyIiwiY2xvbmVCZWZvcmUiLCJtZXNzYWdlIiwib3B0cyIsImVuZCIsInJhbmdlQnkiLCJnZXRQcm94eVByb2Nlc3NvciIsImdldCIsInByb3AiLCJyb290IiwidG9Qcm94eSIsInNldCIsIm1hcmtEaXJ0eSIsIm5leHQiLCJ1bmRlZmluZWQiLCJpbmRleCIsInBvc2l0aW9uQnkiLCJzdHJpbmdSZXByZXNlbnRhdGlvbiIsInBvcyIsInBvc2l0aW9uSW5zaWRlIiwid29yZCIsInRvU3RyaW5nIiwiaW5kZXhPZiIsInN0cmluZyIsInByZXYiLCJsZW5ndGgiLCJlbmRJbmRleCIsInJhdyIsImRlZmF1bHRUeXBlIiwic3RyIiwicmVtb3ZlIiwicmVtb3ZlQ2hpbGQiLCJyZXBsYWNlV2l0aCIsImJvb2ttYXJrIiwiZm91bmRTZWxmIiwicmVzdWx0IiwidG9KU09OIiwiXyIsImlucHV0cyIsImZpeGVkIiwiZW1pdElucHV0cyIsIk1hcCIsImlucHV0c05leHRJbmRleCIsImlucHV0SWQiLCJrZXlzIiwicHJveHlDYWNoZSIsIlByb3h5Iiwic3RyaW5naWZpZXIiLCJ3YXJuIiwidGV4dCIsImRhdGEiLCJwcm94eU9mIiwibW9kdWxlIiwiZXhwb3J0cyIsImRlZmF1bHQiXSwic291cmNlcyI6WyJub2RlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0J1xuXG5sZXQgeyBpc0NsZWFuLCBteSB9ID0gcmVxdWlyZSgnLi9zeW1ib2xzJylcbmxldCBDc3NTeW50YXhFcnJvciA9IHJlcXVpcmUoJy4vY3NzLXN5bnRheC1lcnJvcicpXG5sZXQgU3RyaW5naWZpZXIgPSByZXF1aXJlKCcuL3N0cmluZ2lmaWVyJylcbmxldCBzdHJpbmdpZnkgPSByZXF1aXJlKCcuL3N0cmluZ2lmeScpXG5cbmZ1bmN0aW9uIGNsb25lTm9kZShvYmosIHBhcmVudCkge1xuICBsZXQgY2xvbmVkID0gbmV3IG9iai5jb25zdHJ1Y3RvcigpXG5cbiAgZm9yIChsZXQgaSBpbiBvYmopIHtcbiAgICBpZiAoIU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGkpKSB7XG4gICAgICAvKiBjOCBpZ25vcmUgbmV4dCAyICovXG4gICAgICBjb250aW51ZVxuICAgIH1cbiAgICBpZiAoaSA9PT0gJ3Byb3h5Q2FjaGUnKSBjb250aW51ZVxuICAgIGxldCB2YWx1ZSA9IG9ialtpXVxuICAgIGxldCB0eXBlID0gdHlwZW9mIHZhbHVlXG5cbiAgICBpZiAoaSA9PT0gJ3BhcmVudCcgJiYgdHlwZSA9PT0gJ29iamVjdCcpIHtcbiAgICAgIGlmIChwYXJlbnQpIGNsb25lZFtpXSA9IHBhcmVudFxuICAgIH0gZWxzZSBpZiAoaSA9PT0gJ3NvdXJjZScpIHtcbiAgICAgIGNsb25lZFtpXSA9IHZhbHVlXG4gICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuICAgICAgY2xvbmVkW2ldID0gdmFsdWUubWFwKGogPT4gY2xvbmVOb2RlKGosIGNsb25lZCkpXG4gICAgfSBlbHNlIHtcbiAgICAgIGlmICh0eXBlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAhPT0gbnVsbCkgdmFsdWUgPSBjbG9uZU5vZGUodmFsdWUpXG4gICAgICBjbG9uZWRbaV0gPSB2YWx1ZVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBjbG9uZWRcbn1cblxuY2xhc3MgTm9kZSB7XG4gIGNvbnN0cnVjdG9yKGRlZmF1bHRzID0ge30pIHtcbiAgICB0aGlzLnJhd3MgPSB7fVxuICAgIHRoaXNbaXNDbGVhbl0gPSBmYWxzZVxuICAgIHRoaXNbbXldID0gdHJ1ZVxuXG4gICAgZm9yIChsZXQgbmFtZSBpbiBkZWZhdWx0cykge1xuICAgICAgaWYgKG5hbWUgPT09ICdub2RlcycpIHtcbiAgICAgICAgdGhpcy5ub2RlcyA9IFtdXG4gICAgICAgIGZvciAobGV0IG5vZGUgb2YgZGVmYXVsdHNbbmFtZV0pIHtcbiAgICAgICAgICBpZiAodHlwZW9mIG5vZGUuY2xvbmUgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIHRoaXMuYXBwZW5kKG5vZGUuY2xvbmUoKSlcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5hcHBlbmQobm9kZSlcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXNbbmFtZV0gPSBkZWZhdWx0c1tuYW1lXVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGFkZFRvRXJyb3IoZXJyb3IpIHtcbiAgICBlcnJvci5wb3N0Y3NzTm9kZSA9IHRoaXNcbiAgICBpZiAoZXJyb3Iuc3RhY2sgJiYgdGhpcy5zb3VyY2UgJiYgL1xcblxcc3s0fWF0IC8udGVzdChlcnJvci5zdGFjaykpIHtcbiAgICAgIGxldCBzID0gdGhpcy5zb3VyY2VcbiAgICAgIGVycm9yLnN0YWNrID0gZXJyb3Iuc3RhY2sucmVwbGFjZShcbiAgICAgICAgL1xcblxcc3s0fWF0IC8sXG4gICAgICAgIGAkJiR7cy5pbnB1dC5mcm9tfToke3Muc3RhcnQubGluZX06JHtzLnN0YXJ0LmNvbHVtbn0kJmBcbiAgICAgIClcbiAgICB9XG4gICAgcmV0dXJuIGVycm9yXG4gIH1cblxuICBhZnRlcihhZGQpIHtcbiAgICB0aGlzLnBhcmVudC5pbnNlcnRBZnRlcih0aGlzLCBhZGQpXG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIGFzc2lnbihvdmVycmlkZXMgPSB7fSkge1xuICAgIGZvciAobGV0IG5hbWUgaW4gb3ZlcnJpZGVzKSB7XG4gICAgICB0aGlzW25hbWVdID0gb3ZlcnJpZGVzW25hbWVdXG4gICAgfVxuICAgIHJldHVybiB0aGlzXG4gIH1cblxuICBiZWZvcmUoYWRkKSB7XG4gICAgdGhpcy5wYXJlbnQuaW5zZXJ0QmVmb3JlKHRoaXMsIGFkZClcbiAgICByZXR1cm4gdGhpc1xuICB9XG5cbiAgY2xlYW5SYXdzKGtlZXBCZXR3ZWVuKSB7XG4gICAgZGVsZXRlIHRoaXMucmF3cy5iZWZvcmVcbiAgICBkZWxldGUgdGhpcy5yYXdzLmFmdGVyXG4gICAgaWYgKCFrZWVwQmV0d2VlbikgZGVsZXRlIHRoaXMucmF3cy5iZXR3ZWVuXG4gIH1cblxuICBjbG9uZShvdmVycmlkZXMgPSB7fSkge1xuICAgIGxldCBjbG9uZWQgPSBjbG9uZU5vZGUodGhpcylcbiAgICBmb3IgKGxldCBuYW1lIGluIG92ZXJyaWRlcykge1xuICAgICAgY2xvbmVkW25hbWVdID0gb3ZlcnJpZGVzW25hbWVdXG4gICAgfVxuICAgIHJldHVybiBjbG9uZWRcbiAgfVxuXG4gIGNsb25lQWZ0ZXIob3ZlcnJpZGVzID0ge30pIHtcbiAgICBsZXQgY2xvbmVkID0gdGhpcy5jbG9uZShvdmVycmlkZXMpXG4gICAgdGhpcy5wYXJlbnQuaW5zZXJ0QWZ0ZXIodGhpcywgY2xvbmVkKVxuICAgIHJldHVybiBjbG9uZWRcbiAgfVxuXG4gIGNsb25lQmVmb3JlKG92ZXJyaWRlcyA9IHt9KSB7XG4gICAgbGV0IGNsb25lZCA9IHRoaXMuY2xvbmUob3ZlcnJpZGVzKVxuICAgIHRoaXMucGFyZW50Lmluc2VydEJlZm9yZSh0aGlzLCBjbG9uZWQpXG4gICAgcmV0dXJuIGNsb25lZFxuICB9XG5cbiAgZXJyb3IobWVzc2FnZSwgb3B0cyA9IHt9KSB7XG4gICAgaWYgKHRoaXMuc291cmNlKSB7XG4gICAgICBsZXQgeyBlbmQsIHN0YXJ0IH0gPSB0aGlzLnJhbmdlQnkob3B0cylcbiAgICAgIHJldHVybiB0aGlzLnNvdXJjZS5pbnB1dC5lcnJvcihcbiAgICAgICAgbWVzc2FnZSxcbiAgICAgICAgeyBjb2x1bW46IHN0YXJ0LmNvbHVtbiwgbGluZTogc3RhcnQubGluZSB9LFxuICAgICAgICB7IGNvbHVtbjogZW5kLmNvbHVtbiwgbGluZTogZW5kLmxpbmUgfSxcbiAgICAgICAgb3B0c1xuICAgICAgKVxuICAgIH1cbiAgICByZXR1cm4gbmV3IENzc1N5bnRheEVycm9yKG1lc3NhZ2UpXG4gIH1cblxuICBnZXRQcm94eVByb2Nlc3NvcigpIHtcbiAgICByZXR1cm4ge1xuICAgICAgZ2V0KG5vZGUsIHByb3ApIHtcbiAgICAgICAgaWYgKHByb3AgPT09ICdwcm94eU9mJykge1xuICAgICAgICAgIHJldHVybiBub2RlXG4gICAgICAgIH0gZWxzZSBpZiAocHJvcCA9PT0gJ3Jvb3QnKSB7XG4gICAgICAgICAgcmV0dXJuICgpID0+IG5vZGUucm9vdCgpLnRvUHJveHkoKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiBub2RlW3Byb3BdXG4gICAgICAgIH1cbiAgICAgIH0sXG5cbiAgICAgIHNldChub2RlLCBwcm9wLCB2YWx1ZSkge1xuICAgICAgICBpZiAobm9kZVtwcm9wXSA9PT0gdmFsdWUpIHJldHVybiB0cnVlXG4gICAgICAgIG5vZGVbcHJvcF0gPSB2YWx1ZVxuICAgICAgICBpZiAoXG4gICAgICAgICAgcHJvcCA9PT0gJ3Byb3AnIHx8XG4gICAgICAgICAgcHJvcCA9PT0gJ3ZhbHVlJyB8fFxuICAgICAgICAgIHByb3AgPT09ICduYW1lJyB8fFxuICAgICAgICAgIHByb3AgPT09ICdwYXJhbXMnIHx8XG4gICAgICAgICAgcHJvcCA9PT0gJ2ltcG9ydGFudCcgfHxcbiAgICAgICAgICAvKiBjOCBpZ25vcmUgbmV4dCAqL1xuICAgICAgICAgIHByb3AgPT09ICd0ZXh0J1xuICAgICAgICApIHtcbiAgICAgICAgICBub2RlLm1hcmtEaXJ0eSgpXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBtYXJrRGlydHkoKSB7XG4gICAgaWYgKHRoaXNbaXNDbGVhbl0pIHtcbiAgICAgIHRoaXNbaXNDbGVhbl0gPSBmYWxzZVxuICAgICAgbGV0IG5leHQgPSB0aGlzXG4gICAgICB3aGlsZSAoKG5leHQgPSBuZXh0LnBhcmVudCkpIHtcbiAgICAgICAgbmV4dFtpc0NsZWFuXSA9IGZhbHNlXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgbmV4dCgpIHtcbiAgICBpZiAoIXRoaXMucGFyZW50KSByZXR1cm4gdW5kZWZpbmVkXG4gICAgbGV0IGluZGV4ID0gdGhpcy5wYXJlbnQuaW5kZXgodGhpcylcbiAgICByZXR1cm4gdGhpcy5wYXJlbnQubm9kZXNbaW5kZXggKyAxXVxuICB9XG5cbiAgcG9zaXRpb25CeShvcHRzLCBzdHJpbmdSZXByZXNlbnRhdGlvbikge1xuICAgIGxldCBwb3MgPSB0aGlzLnNvdXJjZS5zdGFydFxuICAgIGlmIChvcHRzLmluZGV4KSB7XG4gICAgICBwb3MgPSB0aGlzLnBvc2l0aW9uSW5zaWRlKG9wdHMuaW5kZXgsIHN0cmluZ1JlcHJlc2VudGF0aW9uKVxuICAgIH0gZWxzZSBpZiAob3B0cy53b3JkKSB7XG4gICAgICBzdHJpbmdSZXByZXNlbnRhdGlvbiA9IHRoaXMudG9TdHJpbmcoKVxuICAgICAgbGV0IGluZGV4ID0gc3RyaW5nUmVwcmVzZW50YXRpb24uaW5kZXhPZihvcHRzLndvcmQpXG4gICAgICBpZiAoaW5kZXggIT09IC0xKSBwb3MgPSB0aGlzLnBvc2l0aW9uSW5zaWRlKGluZGV4LCBzdHJpbmdSZXByZXNlbnRhdGlvbilcbiAgICB9XG4gICAgcmV0dXJuIHBvc1xuICB9XG5cbiAgcG9zaXRpb25JbnNpZGUoaW5kZXgsIHN0cmluZ1JlcHJlc2VudGF0aW9uKSB7XG4gICAgbGV0IHN0cmluZyA9IHN0cmluZ1JlcHJlc2VudGF0aW9uIHx8IHRoaXMudG9TdHJpbmcoKVxuICAgIGxldCBjb2x1bW4gPSB0aGlzLnNvdXJjZS5zdGFydC5jb2x1bW5cbiAgICBsZXQgbGluZSA9IHRoaXMuc291cmNlLnN0YXJ0LmxpbmVcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaW5kZXg7IGkrKykge1xuICAgICAgaWYgKHN0cmluZ1tpXSA9PT0gJ1xcbicpIHtcbiAgICAgICAgY29sdW1uID0gMVxuICAgICAgICBsaW5lICs9IDFcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbHVtbiArPSAxXG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHsgY29sdW1uLCBsaW5lIH1cbiAgfVxuXG4gIHByZXYoKSB7XG4gICAgaWYgKCF0aGlzLnBhcmVudCkgcmV0dXJuIHVuZGVmaW5lZFxuICAgIGxldCBpbmRleCA9IHRoaXMucGFyZW50LmluZGV4KHRoaXMpXG4gICAgcmV0dXJuIHRoaXMucGFyZW50Lm5vZGVzW2luZGV4IC0gMV1cbiAgfVxuXG4gIHJhbmdlQnkob3B0cykge1xuICAgIGxldCBzdGFydCA9IHtcbiAgICAgIGNvbHVtbjogdGhpcy5zb3VyY2Uuc3RhcnQuY29sdW1uLFxuICAgICAgbGluZTogdGhpcy5zb3VyY2Uuc3RhcnQubGluZVxuICAgIH1cbiAgICBsZXQgZW5kID0gdGhpcy5zb3VyY2UuZW5kXG4gICAgICA/IHtcbiAgICAgICAgY29sdW1uOiB0aGlzLnNvdXJjZS5lbmQuY29sdW1uICsgMSxcbiAgICAgICAgbGluZTogdGhpcy5zb3VyY2UuZW5kLmxpbmVcbiAgICAgIH1cbiAgICAgIDoge1xuICAgICAgICBjb2x1bW46IHN0YXJ0LmNvbHVtbiArIDEsXG4gICAgICAgIGxpbmU6IHN0YXJ0LmxpbmVcbiAgICAgIH1cblxuICAgIGlmIChvcHRzLndvcmQpIHtcbiAgICAgIGxldCBzdHJpbmdSZXByZXNlbnRhdGlvbiA9IHRoaXMudG9TdHJpbmcoKVxuICAgICAgbGV0IGluZGV4ID0gc3RyaW5nUmVwcmVzZW50YXRpb24uaW5kZXhPZihvcHRzLndvcmQpXG4gICAgICBpZiAoaW5kZXggIT09IC0xKSB7XG4gICAgICAgIHN0YXJ0ID0gdGhpcy5wb3NpdGlvbkluc2lkZShpbmRleCwgc3RyaW5nUmVwcmVzZW50YXRpb24pXG4gICAgICAgIGVuZCA9IHRoaXMucG9zaXRpb25JbnNpZGUoaW5kZXggKyBvcHRzLndvcmQubGVuZ3RoLCBzdHJpbmdSZXByZXNlbnRhdGlvbilcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKG9wdHMuc3RhcnQpIHtcbiAgICAgICAgc3RhcnQgPSB7XG4gICAgICAgICAgY29sdW1uOiBvcHRzLnN0YXJ0LmNvbHVtbixcbiAgICAgICAgICBsaW5lOiBvcHRzLnN0YXJ0LmxpbmVcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChvcHRzLmluZGV4KSB7XG4gICAgICAgIHN0YXJ0ID0gdGhpcy5wb3NpdGlvbkluc2lkZShvcHRzLmluZGV4KVxuICAgICAgfVxuXG4gICAgICBpZiAob3B0cy5lbmQpIHtcbiAgICAgICAgZW5kID0ge1xuICAgICAgICAgIGNvbHVtbjogb3B0cy5lbmQuY29sdW1uLFxuICAgICAgICAgIGxpbmU6IG9wdHMuZW5kLmxpbmVcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmICh0eXBlb2Ygb3B0cy5lbmRJbmRleCA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgZW5kID0gdGhpcy5wb3NpdGlvbkluc2lkZShvcHRzLmVuZEluZGV4KVxuICAgICAgfSBlbHNlIGlmIChvcHRzLmluZGV4KSB7XG4gICAgICAgIGVuZCA9IHRoaXMucG9zaXRpb25JbnNpZGUob3B0cy5pbmRleCArIDEpXG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKFxuICAgICAgZW5kLmxpbmUgPCBzdGFydC5saW5lIHx8XG4gICAgICAoZW5kLmxpbmUgPT09IHN0YXJ0LmxpbmUgJiYgZW5kLmNvbHVtbiA8PSBzdGFydC5jb2x1bW4pXG4gICAgKSB7XG4gICAgICBlbmQgPSB7IGNvbHVtbjogc3RhcnQuY29sdW1uICsgMSwgbGluZTogc3RhcnQubGluZSB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHsgZW5kLCBzdGFydCB9XG4gIH1cblxuICByYXcocHJvcCwgZGVmYXVsdFR5cGUpIHtcbiAgICBsZXQgc3RyID0gbmV3IFN0cmluZ2lmaWVyKClcbiAgICByZXR1cm4gc3RyLnJhdyh0aGlzLCBwcm9wLCBkZWZhdWx0VHlwZSlcbiAgfVxuXG4gIHJlbW92ZSgpIHtcbiAgICBpZiAodGhpcy5wYXJlbnQpIHtcbiAgICAgIHRoaXMucGFyZW50LnJlbW92ZUNoaWxkKHRoaXMpXG4gICAgfVxuICAgIHRoaXMucGFyZW50ID0gdW5kZWZpbmVkXG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIHJlcGxhY2VXaXRoKC4uLm5vZGVzKSB7XG4gICAgaWYgKHRoaXMucGFyZW50KSB7XG4gICAgICBsZXQgYm9va21hcmsgPSB0aGlzXG4gICAgICBsZXQgZm91bmRTZWxmID0gZmFsc2VcbiAgICAgIGZvciAobGV0IG5vZGUgb2Ygbm9kZXMpIHtcbiAgICAgICAgaWYgKG5vZGUgPT09IHRoaXMpIHtcbiAgICAgICAgICBmb3VuZFNlbGYgPSB0cnVlXG4gICAgICAgIH0gZWxzZSBpZiAoZm91bmRTZWxmKSB7XG4gICAgICAgICAgdGhpcy5wYXJlbnQuaW5zZXJ0QWZ0ZXIoYm9va21hcmssIG5vZGUpXG4gICAgICAgICAgYm9va21hcmsgPSBub2RlXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5wYXJlbnQuaW5zZXJ0QmVmb3JlKGJvb2ttYXJrLCBub2RlKVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmICghZm91bmRTZWxmKSB7XG4gICAgICAgIHRoaXMucmVtb3ZlKClcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gdGhpc1xuICB9XG5cbiAgcm9vdCgpIHtcbiAgICBsZXQgcmVzdWx0ID0gdGhpc1xuICAgIHdoaWxlIChyZXN1bHQucGFyZW50ICYmIHJlc3VsdC5wYXJlbnQudHlwZSAhPT0gJ2RvY3VtZW50Jykge1xuICAgICAgcmVzdWx0ID0gcmVzdWx0LnBhcmVudFxuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0XG4gIH1cblxuICB0b0pTT04oXywgaW5wdXRzKSB7XG4gICAgbGV0IGZpeGVkID0ge31cbiAgICBsZXQgZW1pdElucHV0cyA9IGlucHV0cyA9PSBudWxsXG4gICAgaW5wdXRzID0gaW5wdXRzIHx8IG5ldyBNYXAoKVxuICAgIGxldCBpbnB1dHNOZXh0SW5kZXggPSAwXG5cbiAgICBmb3IgKGxldCBuYW1lIGluIHRoaXMpIHtcbiAgICAgIGlmICghT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHRoaXMsIG5hbWUpKSB7XG4gICAgICAgIC8qIGM4IGlnbm9yZSBuZXh0IDIgKi9cbiAgICAgICAgY29udGludWVcbiAgICAgIH1cbiAgICAgIGlmIChuYW1lID09PSAncGFyZW50JyB8fCBuYW1lID09PSAncHJveHlDYWNoZScpIGNvbnRpbnVlXG4gICAgICBsZXQgdmFsdWUgPSB0aGlzW25hbWVdXG5cbiAgICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuICAgICAgICBmaXhlZFtuYW1lXSA9IHZhbHVlLm1hcChpID0+IHtcbiAgICAgICAgICBpZiAodHlwZW9mIGkgPT09ICdvYmplY3QnICYmIGkudG9KU09OKSB7XG4gICAgICAgICAgICByZXR1cm4gaS50b0pTT04obnVsbCwgaW5wdXRzKVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gaVxuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZS50b0pTT04pIHtcbiAgICAgICAgZml4ZWRbbmFtZV0gPSB2YWx1ZS50b0pTT04obnVsbCwgaW5wdXRzKVxuICAgICAgfSBlbHNlIGlmIChuYW1lID09PSAnc291cmNlJykge1xuICAgICAgICBsZXQgaW5wdXRJZCA9IGlucHV0cy5nZXQodmFsdWUuaW5wdXQpXG4gICAgICAgIGlmIChpbnB1dElkID09IG51bGwpIHtcbiAgICAgICAgICBpbnB1dElkID0gaW5wdXRzTmV4dEluZGV4XG4gICAgICAgICAgaW5wdXRzLnNldCh2YWx1ZS5pbnB1dCwgaW5wdXRzTmV4dEluZGV4KVxuICAgICAgICAgIGlucHV0c05leHRJbmRleCsrXG4gICAgICAgIH1cbiAgICAgICAgZml4ZWRbbmFtZV0gPSB7XG4gICAgICAgICAgZW5kOiB2YWx1ZS5lbmQsXG4gICAgICAgICAgaW5wdXRJZCxcbiAgICAgICAgICBzdGFydDogdmFsdWUuc3RhcnRcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZml4ZWRbbmFtZV0gPSB2YWx1ZVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChlbWl0SW5wdXRzKSB7XG4gICAgICBmaXhlZC5pbnB1dHMgPSBbLi4uaW5wdXRzLmtleXMoKV0ubWFwKGlucHV0ID0+IGlucHV0LnRvSlNPTigpKVxuICAgIH1cblxuICAgIHJldHVybiBmaXhlZFxuICB9XG5cbiAgdG9Qcm94eSgpIHtcbiAgICBpZiAoIXRoaXMucHJveHlDYWNoZSkge1xuICAgICAgdGhpcy5wcm94eUNhY2hlID0gbmV3IFByb3h5KHRoaXMsIHRoaXMuZ2V0UHJveHlQcm9jZXNzb3IoKSlcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMucHJveHlDYWNoZVxuICB9XG5cbiAgdG9TdHJpbmcoc3RyaW5naWZpZXIgPSBzdHJpbmdpZnkpIHtcbiAgICBpZiAoc3RyaW5naWZpZXIuc3RyaW5naWZ5KSBzdHJpbmdpZmllciA9IHN0cmluZ2lmaWVyLnN0cmluZ2lmeVxuICAgIGxldCByZXN1bHQgPSAnJ1xuICAgIHN0cmluZ2lmaWVyKHRoaXMsIGkgPT4ge1xuICAgICAgcmVzdWx0ICs9IGlcbiAgICB9KVxuICAgIHJldHVybiByZXN1bHRcbiAgfVxuXG4gIHdhcm4ocmVzdWx0LCB0ZXh0LCBvcHRzKSB7XG4gICAgbGV0IGRhdGEgPSB7IG5vZGU6IHRoaXMgfVxuICAgIGZvciAobGV0IGkgaW4gb3B0cykgZGF0YVtpXSA9IG9wdHNbaV1cbiAgICByZXR1cm4gcmVzdWx0Lndhcm4odGV4dCwgZGF0YSlcbiAgfVxuXG4gIGdldCBwcm94eU9mKCkge1xuICAgIHJldHVybiB0aGlzXG4gIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBOb2RlXG5Ob2RlLmRlZmF1bHQgPSBOb2RlXG4iXSwibWFwcGluZ3MiOiJBQUFBLFlBQVk7O0FBRVosSUFBSTtFQUFFQSxPQUFPO0VBQUVDO0FBQUcsQ0FBQyxHQUFHQyxPQUFPLENBQUMsV0FBVyxDQUFDO0FBQzFDLElBQUlDLGNBQWMsR0FBR0QsT0FBTyxDQUFDLG9CQUFvQixDQUFDO0FBQ2xELElBQUlFLFdBQVcsR0FBR0YsT0FBTyxDQUFDLGVBQWUsQ0FBQztBQUMxQyxJQUFJRyxTQUFTLEdBQUdILE9BQU8sQ0FBQyxhQUFhLENBQUM7QUFFdEMsU0FBU0ksU0FBU0EsQ0FBQ0MsR0FBRyxFQUFFQyxNQUFNLEVBQUU7RUFDOUIsSUFBSUMsTUFBTSxHQUFHLElBQUlGLEdBQUcsQ0FBQ0csV0FBVyxDQUFDLENBQUM7RUFFbEMsS0FBSyxJQUFJQyxDQUFDLElBQUlKLEdBQUcsRUFBRTtJQUNqQixJQUFJLENBQUNLLE1BQU0sQ0FBQ0MsU0FBUyxDQUFDQyxjQUFjLENBQUNDLElBQUksQ0FBQ1IsR0FBRyxFQUFFSSxDQUFDLENBQUMsRUFBRTtNQUNqRDtNQUNBO0lBQ0Y7SUFDQSxJQUFJQSxDQUFDLEtBQUssWUFBWSxFQUFFO0lBQ3hCLElBQUlLLEtBQUssR0FBR1QsR0FBRyxDQUFDSSxDQUFDLENBQUM7SUFDbEIsSUFBSU0sSUFB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